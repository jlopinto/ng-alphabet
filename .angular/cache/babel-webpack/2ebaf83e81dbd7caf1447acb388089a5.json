{"ast":null,"code":"import { style, transition, trigger, useAnimation } from '@angular/animations';\nimport { letterFalling, found } from 'src/app/animations.module';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/game.service\";\nimport * as i2 from \"src/app/services/letter-store.service\";\nimport * as i3 from \"src/app/services/sounds.service\";\nimport * as i4 from \"@angular/common\";\n\nconst _c0 = function (a0) {\n  return {\n    \"text-uppercase\": a0,\n    \"letter--balancing\": true\n  };\n};\n\nexport let LetterComponent = /*#__PURE__*/(() => {\n  class LetterComponent {\n    constructor(game, store, gameSound) {\n      this.game = game;\n      this.store = store;\n      this.gameSound = gameSound;\n      this.letter = {\n        item: 'G',\n        id: 'nope',\n        isAnimated: false,\n        isFound: false,\n        isLost: false,\n        isUppercase: false\n      };\n      this.fallingState = 'lost';\n      this.zIndexes = ['299', '199', '99'];\n      this.scales = ['1', '0.9', '0.8', '0.7', '0.6'];\n      this.easings = ['cubic-bezier(0.55, 0, 1, 0.45)', 'cubic-bezier(0.32, 0, 0.67, 0)', 'cubic-bezier(0.12, 0, 0.39, 0)'];\n    }\n\n    get fn() {\n      return {\n        value: this.fallingState,\n        params: this.fallingParams\n      };\n    }\n\n    captureDoneEvent($event) {\n      this.hitTest(this.letter, this.fallingState, $event);\n    }\n\n    handleKeyboardEvent(event) {\n      return this.letterFound(event.key);\n    }\n\n    handleClickEvent() {\n      return this.letterFound(this.letter.item);\n    }\n\n    randomPercentage() {\n      const min = 10;\n      const max = 90;\n      const res = Math.floor(Math.random() * (max - min + 1) + min);\n      return res + '%';\n    }\n\n    pickRange() {\n      const index = Math.floor(Math.random() * this.zIndexes.length);\n      return {\n        zIndex: this.zIndexes[index],\n        scale: this.scales[index],\n        yEnd: `calc(100% - ${(index + 1.7) * 3}em)`\n      };\n    }\n\n    randomEase() {\n      return this.easings[Math.floor(Math.random() * this.easings.length)];\n    }\n\n    letterFound(key) {\n      if (this.game.started && this.letter.item === key && this.store.letters.filter(storeLetter => storeLetter.item === this.letter.item && storeLetter.isFound === false)) {\n        if (this.fallingState === 'found') {\n          return;\n        }\n\n        this.fallingState = 'found';\n        this.itemVoiceSound.play();\n        return false;\n      }\n    }\n\n    setFallingParams() {\n      const {\n        zIndex,\n        scale,\n        yEnd\n      } = this.pickRange();\n      const xStart = this.randomPercentage();\n      const xEnd = this.randomPercentage();\n      const res = {\n        fallingSpeed: this.game.randomRangeSecond(),\n        fallingEase: this.randomEase(),\n        xStart,\n        xEnd,\n        yEnd,\n        zIndex,\n        scale\n      };\n      return res;\n    }\n\n    hitTest(letter, state, event) {\n      const {\n        toState,\n        fromState\n      } = event;\n\n      if (this.game.started) {\n        if (fromState === 'lost' && toState === 'found' && state === 'found') {\n          this.store.setFound(this.letter, true);\n        }\n\n        if (fromState === 'void' && toState === 'lost' && state === 'lost') {\n          this.store.setLost(letter, true);\n          this.gameSound.playLostSound();\n        }\n      }\n    }\n\n    ngOnInit() {\n      this.fallingParams = this.setFallingParams();\n      this.itemVoiceSound = new Audio(`../../../assets/audio/${this.letter.item}.mp3`);\n      this.itemVoiceSound.volume = .4;\n    }\n\n  }\n\n  LetterComponent.ɵfac = function LetterComponent_Factory(t) {\n    return new (t || LetterComponent)(i0.ɵɵdirectiveInject(i1.GameService), i0.ɵɵdirectiveInject(i2.LettersStoreService), i0.ɵɵdirectiveInject(i3.SoundService));\n  };\n\n  LetterComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LetterComponent,\n    selectors: [[\"app-letter\"]],\n    hostVars: 1,\n    hostBindings: function LetterComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵsyntheticHostListener(\"@falling.done\", function LetterComponent_animation_falling_done_HostBindingHandler($event) {\n          return ctx.captureDoneEvent($event);\n        });\n        i0.ɵɵlistener(\"keydown\", function LetterComponent_keydown_HostBindingHandler($event) {\n          return ctx.handleKeyboardEvent($event);\n        }, false, i0.ɵɵresolveDocument)(\"tap\", function LetterComponent_tap_HostBindingHandler($event) {\n          return ctx.handleClickEvent($event);\n        });\n      }\n\n      if (rf & 2) {\n        i0.ɵɵsyntheticHostProperty(\"@falling\", ctx.fn);\n      }\n    },\n    inputs: {\n      letter: \"letter\"\n    },\n    decls: 5,\n    vars: 4,\n    consts: [[1, \"letter\", 3, \"ngClass\"], [1, \"letter__inner\"], [1, \"balloon\"], [0, \"xlink\", \"href\", \"#balloon\"]],\n    template: function LetterComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(3, \"svg\", 2);\n        i0.ɵɵelement(4, \"use\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, ctx.letter.isUppercase));\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.letter.item);\n      }\n    },\n    directives: [i4.NgClass],\n    styles: [\"[_nghost-%COMP%]{display:inline-block;position:absolute;left:50%;top:0;transform:translate(-50%);z-index:100;color:#555;font-family:Didact Gothic,sans-serif}.letter[_ngcontent-%COMP%]{position:relative;transform:rotate3d(0,0,0);transition:2s ease-in;-webkit-backface-visibility:hidden;backface-visibility:hidden}.letter--balancing[_ngcontent-%COMP%]{transform-origin:top center;-webkit-animation:2s ease-in-out infinite alternate balancing;animation:2s ease-in-out infinite alternate balancing}.letter__inner[_ngcontent-%COMP%]{position:absolute;font-size:3em;top:50%;left:50%;line-height:1;transform:translate(-50%,calc(-50% - .4em))}@-webkit-keyframes balancing{0%{transform:rotate(-10deg)}to{transform:rotate(10deg)}}@keyframes balancing{0%{transform:rotate(-10deg)}to{transform:rotate(10deg)}}.balloon[_ngcontent-%COMP%]{max-width:4rem;height:auto}.balloon-1[_ngcontent-%COMP%]{fill:#d2691e}.balloon-2[_ngcontent-%COMP%]{fill:#ff1493}.balloon-3[_ngcontent-%COMP%]{fill:gold}.balloon-4[_ngcontent-%COMP%]{fill:#fff}\"],\n    data: {\n      animation: [trigger('falling', [transition(':enter', useAnimation(letterFalling)), transition('* => found', useAnimation(found)), transition(':leave', [style({\n        opacity: 0\n      })])])]\n    }\n  });\n  return LetterComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}